KISSY.add("suggest",function(g,l){var z=g.DOM,L=g.Event,M=window,h=document,U,n=g.get("head"),I=g.UA.ie,p=(I===6),m=(I>=9),D="KISSY.Suggest.callback",q="ks-suggest-",F=q+"style",r=q+"container",C=q+"key",f=q+"result",x="ks-selected",T="ks-odd",y="ks-even",v=q+"content",o=q+"footer",j=q+"closebtn",P=q+"shim",Y="beforeStart",E="itemSelect",A="beforeSubmit",s="beforeDataRequest",V="dataReturn",G="updateFooter",i="beforeShow",c=200,e="",R="hidden",a="display",J="none",u="LI",H="li",t="<div>",X="result",Q="key",Z="data-time",B=parseInt,d=/^(?:input|button|a)$/i,W={containerCls:e,resultFormat:"%result%",closeBtnText:"\u934f\u62bd\u68f4",shim:p,submitOnSelect:true,offset:-1,charset:"utf-8",callbackName:"callback",callbackFn:D,queryName:"q"};function k(ac,ad,ab){var aa=this,S;if(!(aa instanceof k)){return new k(ac,ad,ab)}aa.textInput=g.get(ac);aa.config=ab=g.merge(W,ab);ad+=(ad.indexOf("?")===-1)?"?":"&";aa.dataSource=ad+ab.callbackName+"="+(S=ab.callbackFn);if(S!==D){b(S)}aa.query=e;aa.queryParams=e;aa._dataCache={};aa._init()}g.augment(k,g.EventTarget,{_init:function(){var S=this;U=h.body;S._initTextInput();S._initContainer();if(S.config.shim){S._initShim()}S._initStyle();S._initEvent()},_initTextInput:function(){var aa=this,S=aa.textInput,ac=false,ab=0;z.attr(S,"autocomplete","off");if(aa.config.autoFocus){S.focus()}L.on(S,"keydown",function(ad){var ae=ad.keyCode;if(ae===27){aa.hide();S.value=aa.query}else{if(ae>32&&ae<41){if(!S.value){S.blur()}else{if(ae===40||ae===38){if(ab++===0){if(aa._isRunning){aa.stop()}ac=true;aa._selectItem(ae===40)}else{if(ab==3){ab=0}}ad.preventDefault()}}}else{if(ae===13){S.blur();if(ac){if(S.value==aa._getSelectedItemKey()){if(aa.fire(E)===false){return}}}aa._submitForm()}else{if(!aa._isRunning){aa.start()}ac=false}}}});L.on(S,"keyup",function(){ab=0});L.on(S,"blur",function(){aa.stop();g.later(function(){if(!aa._focusing){aa.hide()}},0)})},_initContainer:function(){var aa=this,ac=aa.config.containerCls,S=z.create(t,{"class":r+(ac?" "+ac:e),style:"position:absolute;visibility:hidden"}),ab=z.create(t,{"class":v}),ad=z.create(t,{"class":o});S.appendChild(ab);S.appendChild(ad);U.insertBefore(S,U.firstChild);aa.container=S;aa.content=ab;aa.footer=ad;aa._initContainerEvent()},_setContainerRegion:function(){var ab=this,ac=ab.config,aa=ab.textInput,ad=z.offset(aa),S=ab.container;z.offset(S,{left:ad.left,top:ad.top+aa.offsetHeight+ac.offset});z.width(S,ac.containerWidth||aa.offsetWidth-2)},_initContainerEvent:function(){var ab=this,aa=ab.textInput,S=ab.container,ad=ab.content,af=ab.footer,ae,ac;L.on(ad,"mousemove",function(ag){var ah=ag.target;if(ah.nodeName!==u){ah=z.parent(ah,H)}if(z.contains(ad,ah)){if(ah!==ab.selectedItem){ab._removeSelectedItem();ab._setSelectedItem(ah)}}});L.on(ad,"mousedown",function(ag){var ah=ag.target;if(ah.nodeName!==u){ah=z.parent(ah,H)}ae=ah});L.on(S,"mousedown",function(ag){if(!d.test(ag.target.nodeName)){aa.onbeforedeactivate=function(){M.event.returnValue=false;aa.onbeforedeactivate=null};ag.preventDefault()}});L.on(ad,"mouseup",function(ag){var ai=ag.target;if(ag.which>2){return}if(ai.nodeName!==u){ai=z.parent(ai,H)}if(ai!=ae){return}if(z.contains(ad,ai)){ab._updateInputFromSelectItem(ai);if(ab.fire(E)===false){return}try{aa.blur()}catch(ah){}ab._submitForm()}});L.on(af,"focusin",function(){ab._focusing=true;ab._removeSelectedItem();ac=false});L.on(af,"focusout",function(){ab._focusing=false;g.later(function(){if(ac){ab.hide()}else{if(!ab._focusing){ab.textInput.focus()}}},0)});L.on(ab.container,"mouseleave",function(){ac=true});L.on(af,"click",function(ag){if(z.hasClass(ag.target,j)){ab.hide()}})},_submitForm:function(){var S=this;if(S.config.submitOnSelect){var ab=S.textInput.form;if(!ab){return}if(S.fire(A,{form:ab})===false){return}if(h.createEvent){var aa=h.createEvent("MouseEvents");aa.initEvent("submit",true,false);ab.dispatchEvent(aa)}else{if(h.createEventObject){ab.fireEvent("onsubmit")}}ab.submit()}},_initShim:function(){var S=z.create("<iframe>",{src:"about:blank","class":P,style:"position:absolute;visibility:hidden;border:none"});this.container.shim=S;U.insertBefore(S,U.firstChild)},_setShimRegion:function(){var aa=this,S=aa.container,ab=S.style,ac=S.shim;if(ac){z.css(ac,{left:B(ab.left)-2,top:ab.top,width:B(ab.width)+2,height:z.height(S)-2})}},_initStyle:function(){var S=g.get("#"+F);if(S){return}z.addStyleSheet(".ks-suggest-container{background:white;border:1px solid #999;z-index:99999}.ks-suggest-shim{z-index:99998}.ks-suggest-container li{color:#404040;padding:1px 0 2px;font-size:12px;line-height:18px;float:left;width:100%}.ks-suggest-container .ks-selected{background-color:#39F;cursor:default}.ks-suggest-key{float:left;text-align:left;padding-left:5px}.ks-suggest-result{float:right;text-align:right;padding-right:5px;color:green}.ks-suggest-container .ks-selected span{color:#FFF;cursor:default}.ks-suggest-footer{padding:0 5px 5px}.ks-suggest-closebtn{float:right}.ks-suggest-container li,.ks-suggest-footer{overflow:hidden;zoom:1;clear:both}.ks-suggest-container{*margin-left:2px;_margin-left:-2px;_margin-top:-3px}",F)},_initEvent:function(){var S=this;L.on(M,"resize",function(){S._setContainerRegion();S._setShimRegion()})},start:function(){var S=this;if(S.fire(Y)===false){return}k.focusInstance=S;S._timer=g.later(function(){S._updateContent();S._timer=g.later(arguments.callee,c)},c);S._isRunning=true},stop:function(){var S=this;k.focusInstance=l;if(S._timer){S._timer.cancel()}S._isRunning=false},show:function(){var aa=this;if(aa.isVisible()){return}var S=aa.container,ab=S.shim;aa._setContainerRegion();w(S);if(ab){aa._setShimRegion();w(ab)}},hide:function(){if(!this.isVisible()){return}var S=this.container,aa=S.shim;if(aa){N(aa)}N(S)},isVisible:function(){return this.container.style.visibility!=R},_updateContent:function(){var aa=this,S=aa.textInput,ab;if(S.value==aa.query){return}ab=aa.query=S.value;if(!g.trim(ab)){aa._fillContainer();aa.hide();return}if(aa._dataCache[ab]!==l){aa._fillContainer(aa._dataCache[ab]);aa._displayContainer()}else{aa._requestData()}},_requestData:function(){var aa=this,ab=aa.config,S;if(!I||m){aa.dataScript=l}if(!aa.dataScript){S=h.createElement("script");S.charset=ab.charset;S.async=true;n.insertBefore(S,n.firstChild);aa.dataScript=S;if(!I||m){var ac=g.now();aa._latestScriptTime=ac;z.attr(S,Z,ac);L.on(S,"load",function(){aa._scriptDataIsOut=z.attr(S,Z)!=aa._latestScriptTime})}}aa.queryParams=ab.queryName+"="+encodeURIComponent(aa.query);if(aa.fire(s)===false){return}aa.dataScript.src=aa.dataSource+"&"+aa.queryParams},_handleResponse:function(aa){var ai=this,ac,af=e,ab,ad,ae,ah,ag,S;if(ai._scriptDataIsOut){return}ai.returnedData=aa;if(ai.fire(V,{data:aa})===false){return}ac=ai._formatData(ai.returnedData);if((ad=ac.length)>0){ae=z.create("<ol>");for(ab=0;ab<ad;++ab){S=ac[ab];ah=ai._formatItem((ag=S[Q]),S[X]);z.attr(ah,Q,ag);z.addClass(ah,ab%2?y:T);ae.appendChild(ah)}af=ae}ai._fillContainer(af);if(ai.fire(i)===false){return}ai._dataCache[ai.query]=z.html(ai.content);ai._displayContainer()},_formatData:function(ae){var aa=[],S,ad,ac,ab=0;if(!ae){return aa}if(g.isArray(ae[X])){ae=ae[X]}if(!(S=ae.length)){return aa}for(ac=0;ac<S;++ac){ad=ae[ac];if(g.isString(ad)){aa[ab++]={key:ad}}else{if(g.isArray(ad)&&ad.length>1){aa[ab++]={key:ad[0],result:ad[1]}}}}return aa},_formatItem:function(ab,aa){var S=z.create("<li>"),ac;S.appendChild(z.create("<span>",{"class":C,html:ab}));if(aa){ac=this.config.resultFormat.replace("%result%",aa);if(g.trim(ac)){S.appendChild(z.create("<span>",{"class":f,html:ac}))}}return S},_fillContainer:function(aa,ab){var S=this;S._fillContent(aa||e);S._fillFooter(ab||e);if(S.isVisible()){S._setShimRegion()}},_fillContent:function(S){O(this.content,S);this.selectedItem=l},_fillFooter:function(ab){var aa=this,S=aa.config,ad=aa.footer,ac;O(ad,ab);if(S.closeBtn){ad.appendChild(z.create("<a>",{"class":j,text:S.closeBtnText,href:"javascript: void(0)",target:"_self"}))}aa.fire(G,{footer:ad,query:aa.query});z.css(ad,a,z.text(ad)?e:J)},_displayContainer:function(){var S=this;if(g.trim(z.text(S.container))){S.show()}else{S.hide()}},_selectItem:function(ac){var ab=this,aa=g.query(H,ab.container),S;if(aa.length===0){return}if(!ab.isVisible()){ab.show();return}if(!ab.selectedItem){S=aa[ac?0:aa.length-1]}else{S=z[ac?"next":"prev"](ab.selectedItem);if(!S){ab.textInput.value=ab.query}}ab._removeSelectedItem();if(S){ab._setSelectedItem(S);ab._updateInputFromSelectItem()}},_removeSelectedItem:function(){z.removeClass(this.selectedItem,x);this.selectedItem=l},_setSelectedItem:function(S){z.addClass(S,x);this.selectedItem=S;this.textInput.focus()},_getSelectedItemKey:function(){var S=this;if(!S.selectedItem){return e}return z.attr(S.selectedItem,Q)},_updateInputFromSelectItem:function(){var S=this;S.textInput.value=S._getSelectedItemKey(S.selectedItem)||S.query}});function w(S){S.style.visibility=e}function N(S){S.style.visibility=R}function O(aa,S){if(S.nodeType===1){z.html(aa,e);aa.appendChild(S)}else{z.html(aa,S)}}function b(aa){var ab=aa.split("."),S=ab.length,ac;if(S>1){aa=aa.replace(/^(.*)\..+$/,"$1");ac=g.namespace(aa,true);ac[ab[S-1]]=K}else{M[aa]=K}}function K(S){if(!k.focusInstance){return}g.later(function(){k.focusInstance._handleResponse(S)},0)}k.version=1.1;k.callback=K;g.Suggest=k},{requires:["core"]});
KISSY.add("anim-easing",function(c){var g=Math,f=g.PI,d=g.pow,a=g.sin,b=1.70158,e={easeNone:function(h){return h},easeIn:function(h){return h*h},easeOut:function(h){return(2-h)*h},easeBoth:function(h){return(h*=2)<1?0.5*h*h:0.5*(1-(--h)*(h-2))},easeInStrong:function(h){return h*h*h*h},easeOutStrong:function(h){return 1-(--h)*h*h*h},easeBothStrong:function(h){return(h*=2)<1?0.5*h*h*h*h:0.5*(2-(h-=2)*h*h*h)},elasticIn:function(h){var j=0.3,i=j/4;if(h===0||h===1){return h}return -(d(2,10*(h-=1))*a((h-i)*(2*f)/j))},elasticOut:function(h){var j=0.3,i=j/4;if(h===0||h===1){return h}return d(2,-10*h)*a((h-i)*(2*f)/j)+1},elasticBoth:function(h){var j=0.45,i=j/4;if(h===0||(h*=2)===2){return h}if(h<1){return -0.5*(d(2,10*(h-=1))*a((h-i)*(2*f)/j))}return d(2,-10*(h-=1))*a((h-i)*(2*f)/j)*0.5+1},backIn:function(h){if(h===1){h-=0.001}return h*h*((b+1)*h-b)},backOut:function(h){return(h-=1)*h*((b+1)*h+b)+1},backBoth:function(h){if((h*=2)<1){return 0.5*(h*h*(((b*=(1.525))+1)*h-b))}return 0.5*((h-=2)*h*(((b*=(1.525))+1)*h+b)+2)},bounceIn:function(h){return 1-e.bounceOut(1-h)},bounceOut:function(h){var i=7.5625,j;if(h<(1/2.75)){j=i*h*h}else{if(h<(2/2.75)){j=i*(h-=(1.5/2.75))*h+0.75}else{if(h<(2.5/2.75)){j=i*(h-=(2.25/2.75))*h+0.9375}else{j=i*(h-=(2.625/2.75))*h+0.984375}}}return j},bounceBoth:function(h){if(h<0.5){return e.bounceIn(h*2)*0.5}return e.bounceOut(h*2-1)*0.5+0.5}};e.NativeTimeFunction={easeNone:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeBoth:"ease-in-out",easeInStrong:"cubic-bezier(0.9, 0.0, 0.9, 0.5)",easeOutStrong:"cubic-bezier(0.1, 0.5, 0.1, 1.0)",easeBothStrong:"cubic-bezier(0.9, 0.0, 0.1, 1.0)"};c.Easing=e});KISSY.add("anim",function(e,g){var u=e.DOM,b=e.Easing,f=parseFloat,c=u.create("<div>"),q=("backgroundColor borderBottomColor borderBottomWidth borderBottomStyle borderLeftColor borderLeftWidth borderLeftStyle borderRightColor borderRightWidth borderRightStyle borderSpacing borderTopColor borderTopWidth borderTopStyle bottom color font fontFamily fontSize fontWeight height left letterSpacing lineHeight marginBottom marginLeft marginRight marginTop maxHeight maxWidth minHeight minWidth opacity outlineColor outlineOffset outlineWidth paddingBottom paddingLeft paddingRight paddingTop right textIndent top width wordSpacing zIndex").split(" "),t=13,r="opacity",j="none",w="Property",v="start",k="step",i="complete",l={duration:1,easing:"easeNone",nativeSupport:true};function x(z,D,A,C,F,B){if(!(z=e.get(z))){return}if(!(this instanceof x)){return new x(z,D,A,C,F,B)}var G=this,E=e.isPlainObject(A),s=D,y;G.domEl=z;if(e.isPlainObject(s)){s=e.param(s,";").replace(/=/g,":").replace(/%23/g,"#").replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}G.props=o(s);G.targetStyle=s;if(E){y=e.merge(l,A)}else{y=e.clone(l);if(A){(y.duration=f(A)||1)}if(e.isString(C)||e.isFunction(C)){y.easing=C}if(e.isFunction(F)){y.complete=F}if(B!==g){y.nativeSupport=B}}G.config=y;if(y.nativeSupport&&p()&&e.isString((C=y.easing))){if(/cubic-bezier\([\s\d.,]+\)/.test(C)||(C=b.NativeTimeFunction[C])){y.easing=C;G.transitionName=p()}}if(e.isFunction(F)){G.on(i,F)}}e.augment(x,e.EventTarget,{run:function(){var H=this,A=H.config,B=H.domEl,D,F,z,G,E=H.props,s={},y,C;for(y in E){s[y]=n(u.css(B,y))}if(H.fire(v)===false){return}H.stop();if(H.transitionName){H._nativeRun()}else{D=A.duration*1000;z=e.now();G=z+D;F=A.easing;if(e.isString(F)){F=b[F]||b.easeNone}H.timer=e.later((C=function(){var L=e.now(),J=L>G?1:(L-z)/D,K,M,I;for(y in E){K=s[y];M=E[y];if(M.v==0){M.u=K.u}if(K.u!==M.u){K.v=0}u.css(B,y,M.f(K.v,M.v,F(J))+M.u)}if((H.fire(k)===false)||(I=L>G)){H.stop();if(I){H.fire(i)}}}),t,true);C()}return H},_nativeRun:function(){var s=this,y=s.config,z=s.domEl,C=s.props,B=y.duration*1000,E=y.easing,A=s.transitionName,D={};e.log("Amin uses native transition.");D[A+"Property"]="all";D[A+"Duration"]=B+"ms";D[A+"TimingFunction"]=E;u.css(z,D);e.later(function(){d(z,C,s.targetStyle)},0);e.later(function(){s.stop(true)},B)},stop:function(y){var s=this;if(s.transitionName){s._nativeStop(y)}else{if(s.timer){s.timer.cancel();s.timer=g}if(y){d(s.domEl,s.props,s.targetStyle);s.fire(i)}}return s},_nativeStop:function(y){var s=this,A=s.domEl,B=s.transitionName,z=s.props,C;if(y){u.css(A,B+w,j);s.fire(i)}else{for(C in z){u.css(A,C,u._getComputedStyle(A,C))}u.css(A,B+w,j)}}});x.supportTransition=function(){return !!p()};e.Anim=x;function p(){var s="transition",y;if(c.style[s]!==g){y=s}else{e.each(["Webkit","Moz","O"],function(z){if(c.style[(s=z+"Transition")]!==g){y=s;return false}})}p=function(){return y};return y}function d(z,y,s){if(e.UA.ie&&s.indexOf(r)>-1){u.css(z,r,y[r].v)}z.style.cssText+=";"+s}function o(A){var z,B={},y=q.length,s;c.innerHTML='<div style="'+A+'"></div>';z=c.firstChild.style;while(y--){if((s=z[q[y]])){B[q[y]]=n(s)}}return B}function n(z){var s=f(z),y=(z+"").replace(/^[-\d.]+/,"");return isNaN(s)?{v:y,u:"",f:a}:{v:s,u:y,f:h}}function h(s,y,z){return(s+(y-s)*z).toFixed(3)}function a(y,C,E){var A=2,z,D,B,F=[],s=[];while(z=3,D=arguments[A-1],A--){if(m(D,0,4)==="rgb("){D=D.match(/\d+/g);while(z--){F.push(~~D[z])}}else{if(m(D,0)==="#"){if(D.length===4){D="#"+m(D,1)+m(D,1)+m(D,2)+m(D,2)+m(D,3)+m(D,3)}while(z--){F.push(parseInt(m(D,1+z*2,2),16))}}else{return C}}}while(z--){B=~~(F[z+3]+(F[z]-F[z+3])*E);s.push(B<0?0:B>255?255:B)}return"rgb("+s.join(",")+")"}function m(y,s,z){return y.substr(s,z||1)}});KISSY.add("anim-node-plugin",function(g,c){var p=g.DOM,l=g.Anim,f=g.Node.prototype,a=g.NodeList.prototype,e="display",k="none",h="overflow",b="hidden",i="opacity",j="height",n="width",o="auto",m={show:[h,i,j,n],fade:[i],slide:[h,j]};g.each([f,a],function(q){q.animate=function(){var r=g.makeArray(arguments);g.each(this,function(s){l.apply(c,[s].concat(r)).run()});return this};g.each({show:["show",1],hide:["show",0],toggle:["toggle"],fadeIn:["fade",1],fadeOut:["fade",0],slideDown:["slide",1],slideUp:["slide",0]},function(s,r){q[r]=function(t,u){if(p[r]&&arguments.length===0){p[r](this)}else{g.each(this,function(v){d(v,s[0],t,u,s[1])})}return this}})});function d(r,u,s,w,t){if(u==="toggle"){t=p.css(r,e)===k?1:0;u="show"}if(t){p.css(r,e,p.data(r,e)||"")}var v={},q={};g.each(m[u],function(x){if(x===h){v[h]=p.css(r,h);p.css(r,h,b)}else{if(x===i){v[i]=p.css(r,i);q.opacity=t?1:0;if(t){p.css(r,i,0)}}else{if(x===j){v[j]=p.css(r,j);q.height=(t?p.css(r,j)||r.naturalHeight:0);if(t){p.css(r,j,0)}}else{if(x===n){v[n]=p.css(r,n);q.width=(t?p.css(r,n)||r.naturalWidth:0);if(t){p.css(r,n,0)}}}}}});new g.Anim(r,q,s,"easeOut",function(){if(!t){var x=r.style,y=x[e];if(y!==k){if(y){p.data(r,e,y)}x[e]=k}if(v[j]){p.css(r,{height:v[j]})}if(v[n]){p.css(r,{width:v[n]})}if(v[i]){p.css(r,{opacity:v[i]})}if(v[h]){p.css(r,{overflow:v[h]})}}if(w&&g.isFunction(w)){w()}}).run()}});
KISSY.add("switchable",function(F){function C(J,H){H=H||{};if(!("markupType" in H)){if(H.panelCls){H.markupType=1}else{if(H.panels){H.markupType=2}}}for(var I=this.constructor;I;){H=F.merge(I.Config,H);I=I.superclass?I.superclass.constructor:null}this.container=B.get(J);this.config=H;this.activeIndex=this.completedIndex=H.activeIndex;if(!(this.activeIndex>-1)){if(typeof H.switchTo!="number"){this.completedIndex=this.activeIndex=0}}this._init();this._initPlugins();this.fire(D);this.activeIndex>-1||typeof H.switchTo=="number"&&this.switchTo(H.switchTo)}function G(I){var H={};H.type=I.originalEvent.type;H.target=I.originalEvent.target||I.originalEvent.srcElement;return{originalEvent:H}}var B=F.DOM,E=F.Event,A=F.EventTarget,D="init";C.Config={markupType:0,navCls:"ks-switchable-nav",contentCls:"ks-switchable-content",triggerCls:"ks-switchable-trigger",panelCls:"ks-switchable-panel",triggers:[],panels:[],hasTriggers:true,triggerType:"mouse",delay:0.1,activeIndex:-1,activeTriggerCls:"ks-active",steps:1,viewSize:[]};C.getDomEvent=G;C.Plugins=[];F.augment(C,A,{_initPlugins:function(){for(var I=this,H=I.constructor;H;){F.each(H.Plugins,function(J){J.init&&J.init(I)});H=H.superclass?H.superclass.constructor:null}},_init:function(){var H=this.config;this._parseMarkup();H.hasTriggers&&this._bindTriggers()},_parseMarkup:function(){var M=this.container,H=this.config,L,J,K=[],I=[];switch(H.markupType){case 0:if(L=B.get("."+H.navCls,M)){K=B.children(L)}J=B.get("."+H.contentCls,M);I=B.children(J);break;case 1:K=B.query("."+H.triggerCls,M);I=B.query("."+H.panelCls,M);break;case 2:K=H.triggers;I=H.panels}M=I.length;this.length=M/H.steps;if(H.hasTriggers&&M>0&&K.length===0){K=this._generateTriggersMarkup(this.length)}this.triggers=F.makeArray(K);this.panels=F.makeArray(I);this.content=J||I[0].parentNode;this.nav=L||H.hasTriggers&&K[0].parentNode},_generateTriggersMarkup:function(L){var H=this.config,K=B.create("<ul>"),I,J;K.className=H.navCls;for(J=0;J<L;J++){I=B.create("<li>");if(J===this.activeIndex){I.className=H.activeTriggerCls}I.innerHTML=J+1;K.appendChild(I)}this.container.appendChild(K);return B.children(K)},_bindTriggers:function(){var M=this,H=M.config,L=M.triggers,J,K,I=L.length;for(K=0;K<I;K++){(function(N){J=L[N];E.on(J,"click",function(O){M._onFocusTrigger(N,O)});if(H.triggerType==="mouse"){E.on(J,"mouseenter",function(O){M._onMouseEnterTrigger(N,O)});E.on(J,"mouseleave",function(){M._onMouseLeaveTrigger(N)})}})(K)}},_onFocusTrigger:function(I,H){if(this._triggerIsValid(I)){this._cancelSwitchTimer();this.switchTo(I,undefined,G(H))}},_onMouseEnterTrigger:function(K,H){var J=this;if(J._triggerIsValid(K)){var I=G(H);J.switchTimer=F.later(function(){J.switchTo(K,undefined,I)},J.config.delay*1000)}},_onMouseLeaveTrigger:function(){this._cancelSwitchTimer()},_triggerIsValid:function(H){return this.activeIndex!==H},_cancelSwitchTimer:function(){if(this.switchTimer){this.switchTimer.cancel();this.switchTimer=undefined}},switchTo:function(O,Q,N,L){var M=this,K=M.config,I=M.triggers,R=M.panels,P=M.activeIndex,H=K.steps,S=P*H,J=O*H;if(!M._triggerIsValid(O)){return M}if(M.fire("beforeSwitch",{toIndex:O})===false){return M}if(K.hasTriggers){M._switchTrigger(P>-1?I[P]:null,I[O])}if(Q===undefined){Q=O>P?"forward":"backward"}M._switchView(P>-1?R.slice(S,S+H):null,R.slice(J,J+H),O,Q,N,function(){L&&L.call(M,O);M.completedIndex=O});M.activeIndex=O;return M},_switchTrigger:function(J,H){var I=this.config.activeTriggerCls;J&&B.removeClass(J,I);B.addClass(H,I)},_switchView:function(M,H,L,J,K,I){M&&B.css(M,"display","none");B.css(H,"display","block");this._fireOnSwitch(L,K);I&&I.call(this)},_fireOnSwitch:function(I,H){this.fire("switch",F.mix(H||{},{currentIndex:I}))},prev:function(I){var H=this.activeIndex;this.switchTo(H>0?H-1:this.length-1,"backward",I)},next:function(I){var H=this.activeIndex;this.switchTo(H<this.length-1?H+1:0,"forward",I)}});return F.Switchable=C});KISSY.add("switchable/aria",function(F,C,H,B){function E(){this.stop&&this.stop()}function A(){this.start&&this.start()}C=F.DOM;H=F.Event;B=F.Switchable;var D=!document.documentElement.hasAttribute?function(I,K){K=K.toLowerCase();var J=C.get(I).getAttributeNode(K);return !!(J&&J.specified)}:function(I,J){J=J.toLowerCase();return C.get(I).hasAttribute(J)};B.Plugins.push({name:"aria",init:function(I){if(I.config.aria){var J=I.container;H.on(J,"focusin",E,I);H.on(J,"focusout",A,I)}}});var G=["a","input","button","object"];B.Aria={setTabIndex:function(I,J){I.tabIndex=J;C.query("*",I).each(function(K){var L=K.nodeName.toLowerCase();if(F.inArray(L,G)){D(K,"oriTabIndex")||C.attr(K,"oriTabIndex",K.tabIndex);K.tabIndex=J!=-1?C.attr(K,"oriTabIndex"):J}})}}});KISSY.add("switchable/accordion/base",function(C,B,D){function A(F,E){if(!(this instanceof A)){return new A(F,E)}A.superclass.constructor.apply(this,arguments);return 0}D=C.Switchable;B=C.DOM;C.extend(A,D,{_switchTrigger:function(G,E){var F=this.config;F.multiple?B.toggleClass(E,F.activeTriggerCls):A.superclass._switchTrigger.apply(this,arguments)},_triggerIsValid:function(E){return A.superclass._triggerIsValid.call(this,E)||this.config.multiple},_switchView:function(J,F,I,K,E,H){var G=F[0];if(this.config.multiple){B.toggle(G);this._fireOnSwitch(I,E);H.call(this)}else{A.superclass._switchView.apply(this,arguments)}}});A.Plugins=[];A.Config={markupType:1,triggerType:"click",multiple:false};return C.Accordion=A});KISSY.add("switchable/accordion/aria",function(W,T,N){function R(b){var B;W.each(this.triggers,function(c){if(c==b||Q.contains(c,b)){B=c}});return B}function M(B){switch(B.keyCode){case K:case D:B.ctrlKey&&!B.altKey&&!B.shiftKey&&B.halt();break;case Z:B.ctrlKey&&!B.altKey&&B.halt()}}function F(c){var b=c.target,B=this.triggers,e=!c.ctrlKey&&!c.shiftKey&&!c.altKey,d=c.ctrlKey&&!c.shiftKey&&!c.altKey;switch(c.keyCode){case A:case G:if(R.call(this,b)&&e){this.switchTo(this.focusIndex);c.halt()}break;case H:case J:if(R.call(this,b)){X.call(this);c.halt()}break;case O:case P:if(R.call(this,b)){Y.call(this);c.halt()}break;case D:if(d){c.halt();Y.call(this)}break;case K:if(d){c.halt();X.call(this)}break;case I:if(e){b=this.focusIndex;this.focusIndex=0;L.call(this,b,0,true);c.halt()}break;case C:if(e){b=B.length-1;B=this.focusIndex;this.focusIndex=b;L.call(this,B,b,true);c.halt()}break;case Z:if(c.ctrlKey&&!c.altKey){c.halt();c.shiftKey?X.call(this):Y.call(this)}}}function L(c,b,B){var e=this.triggers;if(typeof c=="number"){var d=e[c]}c=e[b];if(d){E(d,"-1");Q.removeClass(d,S);d.setAttribute("aria-selected","false")}B&&c.focus();E(c,"0");Q.addClass(c,S);c.setAttribute("aria-selected","true")}function X(){var b=this.triggers,B=this.focusIndex;b=this.focusIndex=B==0?b.length-1:B-1;L.call(this,B,b,true)}function Y(){var b=this.focusIndex,B=this.focusIndex=b==this.triggers.length-1?0:b+1;L.call(this,b,B,true)}function V(c){var b=!!(c.originalEvent.target||c.originalEvent.srcElement),B=this.config.multiple,g=this.completedIndex;c=c.currentIndex;var e=this.triggers[c],d=this.panels[c];if(g>-1){var f=this.triggers[g];g=this.panels[g];E(f,"-1");b&&e.focus();if(!B){g.setAttribute("aria-hidden","true");f.setAttribute("aria-expanded","false")}}E(e,"0");b=d.getAttribute("aria-hidden");d.setAttribute("aria-hidden",b=="false"?"true":"false");e.setAttribute("aria-expanded",b=="false"?"false":"true");L.call(this,this.focusIndex,c);this.focusIndex=c}T=W.Switchable.Aria;N=W.Accordion;var S="ks-switchable-select",U=W.Event,Q=W.DOM,K=33,D=34,C=35,I=36,H=37,J=38,O=39,P=40,Z=9,G=32,A=13;W.mix(N.Config,{aria:false});N.Plugins.push({name:"aria",init:function(c){if(c.config.aria){var b=c.container,B=c.activeIndex;Q.attr(b,"aria-multiselectable",c.config.multiple?"true":"false");Q.attr(b,"role","tablist");var f=c.triggers,e=c.panels,d=0;W.each(e,function(g){if(!g.id){g.id=W.guid("ks-switchable-tab-panel")}});W.each(f,function(g){if(!g.id){g.id=W.guid("ks-switchable-tab")}});W.each(f,function(g){g.setAttribute("role","tab");g.setAttribute("aria-expanded",B==d?"true":"false");g.setAttribute("aria-selected",B==d?"true":"false");g.setAttribute("aria-controls",e[d].id);E(g,B==d?"0":"-1");d++});d=0;W.each(e,function(h){var g=f[d];h.setAttribute("role","tabpanel");h.setAttribute("aria-hidden",B==d?"false":"true");h.setAttribute("aria-labelledby",g.id);d++});c.on("switch",V,c);if(B>-1){c.focusIndex=B}U.on(b,"keydown",F,c);U.on(b,"keypress",M,c)}}});var E=T.setTabIndex});KISSY.add("switchable/autoplay",function(C,B,D,A){B=C.Event;D=C.Switchable;C.mix(D.Config,{autoplay:false,interval:5,pauseOnHover:true});D.Plugins.push({name:"autoplay",init:function(H){function F(){E=C.later(function(){H.paused||H.switchTo(H.activeIndex<H.length-1?H.activeIndex+1:0,"forward")},I,true)}var G=H.config,I=G.interval*1000,E;if(G.autoplay){if(G.pauseOnHover){B.on(H.container,"mouseenter",function(){H.stop()});B.on(H.container,"mouseleave",function(){H.start()})}F();H.stop=function(){if(E){E.cancel();E=A}H.paused=true};H.start=function(){if(E){E.cancel();E=A}H.paused=false;F()}}}});return D});KISSY.add("switchable/autorender",function(C,B,D,A){B=C.DOM;D=C.JSON;A=C.Switchable;A.autoRender=function(F,E){F="."+(F||"KS_Widget");B.query(F,E).each(function(I){var J=I.getAttribute("data-widget-type"),G;if(J&&"Switchable Tabs Slide Carousel Accordion".indexOf(J)>-1){try{if(G=I.getAttribute("data-widget-config")){G=G.replace(/'/g,'"')}new C[J](I,D.parse(G))}catch(H){}}})}});KISSY.add("switchable/carousel/base",function(F,C,G,B,E){function A(I,H){if(!(this instanceof A)){return new A(I,H)}A.superclass.constructor.apply(this,arguments)}B=F.Switchable;C=F.DOM;G=F.Event;var D={originalEvent:{target:1}};A.Config={circular:true,prevBtnCls:"ks-switchable-prev-btn",nextBtnCls:"ks-switchable-next-btn",disableBtnCls:"ks-switchable-disable-btn"};A.Plugins=[];F.extend(A,B,{_init:function(){var K=this;A.superclass._init.call(K);var H=K.config,J=H.disableBtnCls,I=false;F.each(["prev","next"],function(M){var L=K[M+"Btn"]=C.get("."+H[M+"BtnCls"],K.container);L&&G.on(L,"click",function(N){N.preventDefault();I||C.hasClass(L,J)||K[M](D)})});if(!H.circular){K.on("beforeSwitch",function(){I=true});K.on("switch",function(L){L=L.currentIndex;L=L===0?K.prevBtn:L===K.length-1?K.nextBtn:E;C.removeClass([K.prevBtn,K.nextBtn],J);L&&C.addClass(L,J);I=false})}G.on(K.panels,"click",function(){K.fire("itemSelected",{item:this})})}});return F.Carousel=A});KISSY.add("switchable/carousel/aria",function(R,O,K,M,J){function D(B){var W=B.currentIndex,V=this.completedIndex,X=this.panels,Y=X[W*this.config.steps],U=this.triggers;W=U[W];if((B=!!(B.originalEvent.target||B.originalEvent.srcElement))||V==-1){R.each(U,function(Z){E(Z,-1)});R.each(X,function(Z){E(Z,-1)});W&&E(W,0);E(Y,0);B&&Y.focus()}}function I(B){var U;R.each(this.triggers,function(V){if(V==B||O.contains(V,B)){U=V;return false}});return U}function S(B){var V=B.target;switch(B.keyCode){case C:case H:if(V=I.call(this,V)){V=V;var U=O.next(V),W=this.triggers;U||(U=W[0]);E(V,-1);if(U){E(U,0);U.focus()}B.halt()}break;case L:case P:if(V=I.call(this,V)){V=V;U=O.prev(V);W=this.triggers;U||(U=W[W.length-1]);E(V,-1);if(U){E(U,0);U.focus()}B.halt()}break;case F:case A:if(V=I.call(this,V)){this.switchTo(R.indexOf(V,this.triggers),undefined,G);B.halt()}}}function T(B){var U;R.each(this.panels,function(V){if(V==B||O.contains(V,B)){U=V;return false}});return U}function Q(B){var V=R.indexOf(B,this.panels),U=this.config.steps,W=Math.floor(V/U);if(W==this.activeIndex){return 1}if(V%U==0||V%U==U-1){this.switchTo(W,undefined,undefined,function(){B.focus()});return 0}return 1}function N(B){var V=B.target;switch(B.keyCode){case C:case H:if(V=T.call(this,V)){V=V;var U=O.next(V),W=this.panels;U||(U=W[0]);E(V,-1);E(U,0);Q.call(this,U)&&U.focus();B.halt()}break;case L:case P:if(V=T.call(this,V)){V=V;U=O.prev(V);W=this.panels;U||(U=W[W.length-1]);E(V,-1);E(U,0);Q.call(this,U)&&U.focus();B.halt()}break;case F:case A:if(V=T.call(this,V)){this.fire("itemSelected",{item:V});B.halt()}}}O=R.DOM;K=R.Event;M=R.Switchable.Aria;J=R.Carousel;var P=37,L=38,H=39,C=40,A=32,F=13,E=M.setTabIndex,G={originalEvent:{target:1}};R.mix(J.Config,{aria:false});J.Plugins.push({name:"aria",init:function(B){if(B.config.aria){var V=B.triggers,U=B.panels,W=B.content,X=B.activeIndex;if(!W.id){W.id=R.guid("ks-switchbale-content")}W.setAttribute("role","listbox");R.each(V,function(Y){E(Y,X==0?"0":"-1");Y.setAttribute("role","button");Y.setAttribute("aria-controls",W.id)});R.each(U,function(Y){E(Y,-1);Y.setAttribute("role","option")});B.on("switch",D,B);(V=B.nav)&&K.on(V,"keydown",S,B);K.on(W,"keydown",N,B);V=B.prevBtn;U=B.nextBtn;if(V){E(V,0);V.setAttribute("role","button");K.on(V,"keydown",function(Y){if(Y.keyCode==F||Y.keyCode==A){B.prev(G);Y.preventDefault()}})}if(U){E(U,0);U.setAttribute("role","button");K.on(U,"keydown",function(Y){if(Y.keyCode==F||Y.keyCode==A){B.next(G);Y.preventDefault()}})}}}})});KISSY.add("switchable/effect",function(F,C,G,B,E,A){C=F.DOM;B=F.Anim;E=F.Switchable;var D;F.mix(E.Config,{effect:"none",duration:0.5,easing:"easeNone",nativeAnim:true});E.Effects={none:function(J,H,I){J&&C.css(J,"display","none");C.css(H,"display","block");I()},fade:function(N,H,M){N&&N.length!==1&&F.error("fade effect only supports steps == 1.");var J=this,L=J.config,I=N?N[0]:null,K=H[0];if(J.anim){J.anim.stop();C.css(J.anim.fromEl,{zIndex:1,opacity:0});C.css(J.anim.toEl,{zIndex:9})}C.css(K,"opacity",1);if(I){J.anim=(new B(I,{opacity:0},L.duration,L.easing,function(){J.anim=A;C.css(K,"z-index",9);C.css(I,"z-index",1);M&&M()},L.nativeAnim)).run();J.anim.toEl=K;J.anim.fromEl=I}else{C.css(K,"z-index",9);M&&M()}},scroll:function(N,H,M,J){var L=this;H=L.config;var I=H.effect==="scrollx",K={};K[I?"left":"top"]=-(L.viewSize[I?0:1]*J)+"px";L.anim&&L.anim.stop();if(N){L.anim=(new B(L.content,K,H.duration,H.easing,function(){L.anim=A;M&&M()},H.nativeAnim)).run()}else{C.css(L.content,K);M&&M()}}};D=E.Effects;D.scrollx=D.scrolly=D.scroll;E.Plugins.push({name:"effect",init:function(N){var P=N.config,M=P.effect,K=N.panels,L=N.content,J=P.steps,I=N.activeIndex,Q=K.length;N.viewSize=[P.viewSize[0]||K[0].offsetWidth*J,P.viewSize[1]||K[0].offsetHeight*J];if(M!=="none"){F.each(K,function(S){C.css(S,"display","block")});switch(M){case"scrollx":case"scrolly":C.css(L,"position","absolute");C.css(L.parentNode,"position","relative");if(M==="scrollx"){C.css(K,"float","left");C.width(L,N.viewSize[0]*(Q/J))}break;case"fade":var O=I*J,H=O+J-1,R;F.each(K,function(T,S){R=S>=O&&S<=H;C.css(T,{opacity:R?1:0,position:"absolute",zIndex:R?9:1})})}}}});F.augment(E,{_switchView:function(O,I,N,K,M,J){var L=this,H=L.config.effect;(F.isFunction(H)?H:D[H]).call(L,O,I,function(){L._fireOnSwitch(N,M);J&&J.call(L)},N,K)}});return E});KISSY.add("switchable/circular",function(K,H,D,F){function C(Q,d,S,U,V){var Y=this;Q=Y.config;d=Y.length;var c=Y.activeIndex,X=Q.scrollType===M,Z=X?J:G,W=Y.viewSize[X?0:1];X=-W*U;var b={},T,R=V===O;if(T=R&&c===0&&U===d-1||V===A&&c===d-1&&U===0){X=P.call(Y,Y.panels,U,R,Z,W)}b[Z]=X+E;Y.anim&&Y.anim.stop();Y.anim=(new D(Y.content,b,Q.duration,Q.easing,function(){T&&B.call(Y,Y.panels,U,R,Z,W);Y.anim=undefined;S()},Q.nativeAnim)).run()}function P(V,U,X,Q,S){var R=this.config.steps;U=this.length;var T=X?U-1:0,W=(T+1)*R;for(R=T*R;R<W;R++){H.css(V[R],L,N);H.css(V[R],Q,(X?-1:1)*S*U)}return X?S:-S*U}function B(V,U,X,Q,S){var R=this.config.steps;U=this.length;var T=X?U-1:0,W=(T+1)*R;for(R=T*R;R<W;R++){H.css(V[R],L,I);H.css(V[R],Q,I)}H.css(this.content,Q,X?-S*(U-1):I)}H=K.DOM;D=K.Anim;F=K.Switchable;var L="position",N="relative",J="left",G="top",I="",E="px",A="forward",O="backward",M="scrollx";K.mix(F.Config,{circular:false});F.Plugins.push({name:"circular",init:function(Q){Q=Q.config;if(Q.circular&&(Q.effect===M||Q.effect==="scrolly")){Q.scrollType=Q.effect;Q.effect=C}}})});KISSY.add("switchable/countdown",function(E,C,F,B,D,A){C=E.DOM;F=E.Event;B=E.Anim;D=E.Switchable;E.mix(D.Config,{countdown:false,countdownFromStyle:"",countdownToStyle:"width: 0"});D.Plugins.push({name:"countdown",init:function(H){function M(Q){O();N=(new B(I[Q],P,K-1)).run()}function O(){if(J){clearTimeout(J);J=null}if(N){N.stop();N=A}}var L=H.config,J,K=L.interval,I=[],G=L.countdownFromStyle,P=L.countdownToStyle,N;if(!(!L.autoplay||!L.hasTriggers||!L.countdown)){E.each(H.triggers,function(R,Q){R.innerHTML='<div class="ks-switchable-trigger-mask"></div><div class="ks-switchable-trigger-content">'+R.innerHTML+"</div>";I[Q]=R.firstChild});if(L.pauseOnHover){F.on(H.container,"mouseenter",function(){O();var Q=I[H.activeIndex];if(G){N=(new B(Q,G,0.2,"easeOut")).run()}else{C.removeAttr(Q,"style")}});F.on(H.container,"mouseleave",function(){O();var Q=H.activeIndex;C.removeAttr(I[Q],"style");J=setTimeout(function(){M(Q)},200)})}H.on("beforeSwitch",function(){O();if(H.activeIndex>-1){C.attr(I[H.activeIndex],"style",G||"")}});H.on("switch",function(Q){H.paused||M(Q.currentIndex)})}}});return D});KISSY.add("switchable/lazyload",function(F,C,G){C=F.DOM;G=F.Switchable;var B="beforeSwitch",E="img-src",A="area-data",D={};D[E]="data-ks-lazyload-custom";D[A]="ks-datalazyload-custom";F.mix(G.Config,{lazyDataType:A});G.Plugins.push({name:"lazyload",init:function(M){function H(P){var N=J.steps;P=P.toIndex*N;L.loadCustomLazyData(M.panels.slice(P,P+N),K);a:{var Q,O;if(P=(N=K===E)?"img":K===A?"textarea":""){P=C.query(P,M.container);Q=0;for(O=P.length;Q<O;Q++){if(N?C.attr(P[Q],I):C.hasClass(P[Q],I)){N=false;break a}}}N=true}N&&M.detach(B,H)}var L=F.DataLazyload,J=M.config,K=J.lazyDataType,I=D[K];!L||!K||!I||M.on(B,H)}});return G});KISSY.add("switchable/slide/base",function(B,A){function C(D,E){if(!(this instanceof C)){return new C(D,E)}C.superclass.constructor.apply(this,arguments);return 0}A=B.Switchable;C.Config={autoplay:true,circular:true};C.Plugins=[];B.extend(C,A);return B.Slide=C});KISSY.add("switchable/slide/aria",function(I,F,C,D,B){function L(M){switch(M.keyCode){case H:case K:this.next(E);M.halt();break;case J:case A:this.prev(E);M.halt()}}D=I.Switchable;F=I.DOM;C=I.Event;D=D.Aria;B=I.Slide;var A=37,J=38,K=39,H=40;I.mix(B.Config,{aria:false});var E={originalEvent:{target:1}},G=D.setTabIndex;B.Plugins.push({name:"aria",init:function(N){if(N.config.aria){var P=N.panels,M=0,Q=N.activeIndex;I.each(N.triggers,function(R){G(R,"-1");M++});M=0;I.each(P,function(R){G(R,Q==M?"0":"-1");F.attr(R,"role","option");M++});var O=N.content;F.attr(O,"role","listbox");C.on(O,"keydown",L,N);G(P[0],0);N.on("switch",function(S){var T=!!(S.originalEvent.target||S.originalEvent.srcElement);S=S.currentIndex;var R=N.completedIndex;R>-1&&G(P[R],-1);G(P[S],0);T&&P[S].focus()})}}})});KISSY.add("switchable/tabs/base",function(B,A){function C(D,E){if(!(this instanceof C)){return new C(D,E)}C.superclass.constructor.call(this,D,E);return 0}A=B.Switchable;B.extend(C,A);C.Config={};C.Plugins=[];return B.Tabs=C});KISSY.add("switchable/tabs/aria",function(T,Q,K){function O(B){var W;T.each(this.triggers,function(X){if(X==B||S.contains(X,B)){W=X}});return W}function J(B){switch(B.keyCode){case P:case R:B.ctrlKey&&!B.altKey&&!B.shiftKey&&B.halt();break;case G:B.ctrlKey&&!B.altKey&&B.halt()}}function D(W){var X=W.target,Z=this.triggers,B=!W.ctrlKey&&!W.shiftKey&&!W.altKey,Y=W.ctrlKey&&!W.shiftKey&&!W.altKey;switch(W.keyCode){case C:case A:if(O.call(this,X)){this.prev(L(W));W.halt()}break;case F:case E:if(O.call(this,X)){this.next(L(W));W.halt()}break;case R:if(Y){W.halt();this.next(L(W))}break;case P:if(Y){W.halt();this.prev(L(W))}break;case H:if(B){this.switchTo(0,undefined,L(W));W.halt()}break;case N:if(B){this.switchTo(Z.length-1,undefined,L(W));W.halt()}break;case G:if(W.ctrlKey&&!W.altKey){W.halt();W.shiftKey?this.prev(L(W)):this.next(L(W))}}}function I(W){var X=!!(W.originalEvent.target||W.originalEvent.srcElement),Z=this.completedIndex,B=W.currentIndex;if(Z!=B){W=this.triggers[Z];var Y=this.triggers[B];Z=this.panels[Z];B=this.panels[B];W&&M(W,"-1");M(Y,"0");X&&Y.focus();Z&&Z.setAttribute("aria-hidden","true");B.setAttribute("aria-hidden","false")}}var U=T.Switchable;Q=U.Aria;K=T.Tabs;var V=T.Event,S=T.DOM,P=33,R=34,N=35,H=36,C=37,A=38,F=39,E=40,G=9;T.mix(K.Config,{aria:false});var L=U.getDomEvent;K.Plugins.push({name:"aria",init:function(W){if(W.config.aria){var Y=W.triggers,b=W.activeIndex,B=W.panels,Z=W.container;W.nav&&S.attr(W.nav,"role","tablist");var X=0;T.each(Y,function(c){c.setAttribute("role","tab");M(c,b==X?"0":"-1");if(!c.id){c.id=T.guid("ks-switchable")}X++});X=0;T.each(B,function(c){var d=Y[X];c.setAttribute("role","tabpanel");c.setAttribute("aria-hidden",b==X?"false":"true");c.setAttribute("aria-labelledby",d.id);X++});W.on("switch",I,W);V.on(Z,"keydown",D,W);V.on(Z,"keypress",J,W)}}});var M=Q.setTabIndex});/*
Copyright 2010, KISSY UI Library v1.1.6
MIT Licensed
build time: Dec 14 18:01
*/
KISSY.add("datalazyload",function(c,r){function i(a,b){if(!(this instanceof i))return new i(a,b);if(b===r){b=a;a=[m]}c.isArray(a)||(a=[c.get(a)||m]);this.containers=a;this.config=c.merge(s,b);this.callbacks={els:[],fns:[]};this._init()}var f=c.DOM,k=c.Event,l=window,m=document,n="scroll",o="resize",s={mod:"manual",diff:"default",placeholder:"none"};c.augment(i,{_init:function(){this.threshold=this._getThreshold();this._filterItems();this._initLoadEvent()},_filterItems:function(){var a=this.containers,
b,d,e,h=[],g=[];b=0;for(d=a.length;b<d;++b){e=c.query("img",a[b]);h=h.concat(c.filter(e,this._filterImg,this));e=c.query("textarea",a[b]);g=g.concat(c.filter(e,this._filterArea,this))}this.images=h;this.areaes=g},_filterImg:function(a){var b=a.getAttribute("data-ks-lazyload"),d=this.threshold,e=this.config.placeholder;if(this.config.mod==="manual"){if(b){if(e!=="none")a.src=e;return true}}else if(f.offset(a).top>d&&!b){f.attr(a,"data-ks-lazyload",a.src);if(e!=="none")a.src=e;else a.removeAttribute("src");
return true}},_filterArea:function(a){return f.hasClass(a,"ks-datalazyload")},_initLoadEvent:function(){function a(){d||(d=c.later(function(){b();d=null},100))}function b(){e._loadItems();if(e._getItemsLength()===0){k.remove(l,n,a);k.remove(l,o,h)}}var d,e=this,h;k.on(l,n,a);k.on(l,o,h=function(){e.threshold=e._getThreshold();a()});e._getItemsLength()&&c.ready(function(){b()})},_loadItems:function(){this._loadImgs();this._loadAreas();this._fireCallbacks()},_loadImgs:function(){this.images=c.filter(this.images,
this._loadImg,this)},_loadImg:function(a){var b=this.threshold+f.scrollTop();if(f.offset(a).top<=b)this._loadImgSrc(a);else return true},_loadImgSrc:function(a,b){b=b||"data-ks-lazyload";var d=a.getAttribute(b);if(d&&a.src!=d){a.src=d;a.removeAttribute(b)}},_loadAreas:function(){this.areaes=c.filter(this.areaes,this._loadArea,this)},_loadArea:function(a){var b=f.css(a,"display")==="none";if(f.offset(b?a.parentNode:a).top<=this.threshold+f.scrollTop())this._loadAreaData(a.parentNode,a);else return true},
_loadAreaData:function(a,b){b.style.display="none";b.className="";var d=f.create("<div>");a.insertBefore(d,b);f.html(d,b.value,true)},_fireCallbacks:function(){var a=this.callbacks,b=a.els,d=a.fns,e=this.threshold+f.scrollTop(),h,g,j,p=[],q=[];for(h=0;(g=b[h])&&(j=d[h++]);)if(f.offset(g).top<=e)j.call(g);else{p.push(g);q.push(j)}a.els=p;a.fns=q},addCallback:function(a,b){var d=this.callbacks;if((a=c.get(a))&&c.isFunction(b)){d.els.push(a);d.fns.push(b)}},_getThreshold:function(){var a=this.config.diff,
b=f.viewportHeight();return a==="default"?2*b:b+ +a},_getItemsLength:function(){return this.images.length+this.areaes.length+this.callbacks.els.length},loadCustomLazyData:function(a,b){var d=this,e,h;c.isArray(a)||(a=[c.get(a)]);c.each(a,function(g){switch(b){case "img-src":h=g.nodeName==="IMG"?[g]:c.query("img",g);c.each(h,function(j){d._loadImgSrc(j,"data-ks-lazyload-custom")});break;default:(e=c.get("textarea",g))&&f.hasClass(e,"ks-datalazyload-custom")&&d._loadAreaData(g,e)}})}});c.mix(i,i.prototype,
true,["loadCustomLazyData","_loadImgSrc","_loadAreaData"]);c.DataLazyload=i},{requires:["core"]});
/*
Copyright 2010, KISSY UI Library v1.1.6
MIT Licensed
build time: Dec 14 18:01
*/
KISSY.add("ajax",function(d,B){function i(a){a=d.merge(J,a);if(a.url){if(a.data&&!d.isString(a.data))a.data=d.param(a.data);a.context=a.context||a;var b,e=n,g,f=a.type.toUpperCase();if(a.dataType===w){b=a.jsonpCallback||w+d.now();a.url=a.url+(a.url.indexOf("?")===-1?"?":"&")+(a.jsonp+"="+b);a.dataType=C;var o=j[b];j[b]=function(k){if(d.isFunction(o))o(k);else{j[b]=B;try{delete j[b]}catch(h){}}p([n,q],k,e,c,a)}}if(a.data&&f===x)a.url=a.url+(a.url.indexOf("?")===-1?"?":"&")+a.data;if(a.dataType===C){l(D,
a);f=d.getScript(a.url,b?null:function(){p([n,q],t,e,c,a)});l(E,a);return f}var r=false,c=a.xhr();l(D,a);c.open(f,a.url,a.async);try{if(a.data||a.contentType)c.setRequestHeader(F,a.contentType);c.setRequestHeader("Accept",a.dataType&&a.accepts[a.dataType]?a.accepts[a.dataType]+", */*; q=0.01":a.accepts._default)}catch(L){}c.onreadystatechange=function(k){if(!c||c.readyState===0||k==="abort"){r||p(q,null,s,c,a);r=true;if(c)c.onreadystatechange=G}else if(!r&&c&&(c.readyState===4||k===u)){r=true;c.onreadystatechange=
G;var h;if(k===u)h=u;else{a:{try{h=c.status>=200&&c.status<300||c.status===304||c.status===1223;break a}catch(M){}h=false}h=h?n:s}e=h;try{h=c;var v=a.dataType,y=t,H,m=h;if(!d.isString(m)){y=h.getResponseHeader(F)||t;m=(H=v==="xml"||!v&&y.indexOf("xml")>=0)?h.responseXML:h.responseText;if(H&&m.documentElement.nodeName===z)throw z;}if(d.isString(m))if(v===A||!v&&y.indexOf(A)>=0)m=d.JSON.parse(m);g=m}catch(N){e=z}p([e===n?n:s,q],g,e,c,a);if(k===u){c.abort();l(K,a)}if(a.async)c=null}};l(E,a);try{c.send(f===
I?a.data:null)}catch(O){p([s,q],g,s,c,a)}a.async||l(q,a);return c}}function p(a,b,e,g,f){if(d.isArray(a))d.each(a,function(o){p(o,b,e,g,f)});else{e===a&&f[a]&&f[a].call(f.context,b,e,g);l(a,f)}}function l(a,b){i.fire(a,{ajaxConfig:b})}var j=window,G=function(){},x="GET",I="POST",F="Content-Type",A="json",w=A+"p",C="script",t="",D="start",E="send",K="stop",n="success",q="complete",s="error",u="timeout",z="parsererror",J={type:x,url:t,contentType:"application/x-www-form-urlencoded",async:true,data:null,
xhr:j.ActiveXObject?function(){if(j.XmlHttpRequest)try{return new j.XMLHttpRequest}catch(a){}try{return new j.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}:function(){return new j.XMLHttpRequest},accepts:{xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"},jsonp:"callback"};d.mix(i,d.EventTarget);d.mix(i,{get:function(a,b,e,g,f){if(d.isFunction(b)){g=e;e=b}return i({type:f||x,
url:a,data:b,success:function(o,r,c){e&&e.call(this,o,r,c)},dataType:g})},post:function(a,b,e,g){if(d.isFunction(b)){g=e;e=b;b=B}return i.get(a,b,e,g,I)},jsonp:function(a,b,e){if(d.isFunction(b)){e=b;b=null}return i.get(a,b,e,w)}});i.getScript=d.getScript;d.io=d.ajax=i.ajax=i;d.jsonp=i.jsonp;d.IO=i});
